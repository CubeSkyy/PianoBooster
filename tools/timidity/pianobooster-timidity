#!/bin/sh

# This script runs pinobooster with timidity
# It supports ALSA only
# TiMidity in Debian compilled without Libao mode -OO, using ALSA pcm device instead -Os
# License: same with Pianobooster
# Author: Alexey Loginov <alexl@mageia.org>

timidity=`timidity -v 2>/dev/null`

if [ -z "$timidity" ]
then
  timidity=`timidity -h 2>/dev/null`
fi

if [ -z "$timidity" ]
then
   echo "Error: timidity was not found or broken!"
   exit 1
fi

if [ ! -z "`timidity -help|grep '\-iA'`" ]
then
  if [ ! -z "`timidity -help|grep '\-OO'`" ]
  then
    timidity -iA -OO &
  else
    if [ ! -z "`timidity -help|grep '\-Os'`" ]
    then
      timidity -iA -Os &
    else
      echo "Error: timidity does not have -OO or -Os options!"
      exit 1
    fi
  fi
else
  echo "Error: timidity does not have -iA option!"
  exit 1
fi

PID=$!

pianobooster

kill $PID
