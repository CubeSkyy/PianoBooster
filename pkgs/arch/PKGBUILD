build_with_cmake="0"

pkgdesc='A MIDI file player that teaches you how to play the piano'
pkgname='pianobooster'
pkgver=0.7.0
pkgrel=1
makedepends=('cmake' 'alsa-lib' 'freetype2' 'ftgl' 'mesa' 'glu' 'qt5-base' 'qt5-tools' 'rtmidi' 'jack2' 'fluidsynth' 'hicolor-icon-theme')
depends=('ttf-dejavu' 'unzip' 'hicolor-icon-theme' 'timidity++' 'fluidsynth' 'soundfont-fluid' 'libnotify' 'alsa-lib' 'freetype2' 'ftgl' 'mesa' 'glu' 'qt5-base' 'rtmidi' 'jack2' )
optdepends=('qt5-translations')
arch=('x86_64')
groups=('qt5')
url='https://github.com/captnfab/PianoBooster'
license=('GPL3+')
source=("pianobooster-${pkgver}.tar.gz")
md5sums=('SKIP')

build () {
    cd "${pkgname}-${pkgver}"
if [ "$build_with_cmake" = "1" ]
then
    cmake . \
       -DUSE_SYSTEM_FONT=ON \
       -DINSTALL_ALL_LANGS=ON \
       -DUSE_SYSTEM_RTMIDI=ON \
       -DWITH_MAN=ON \
       -DWITH_TIMIDITY=ON \
       -DWITH_FLUIDSYNTH=ON \
       -DUSE_FLUIDSYNTH=ON \
       -DCMAKE_INSTALL_PREFIX="${pkgdir}/usr"
else
     qmake-qt5 \
        USE_SYSTEM_FONT=ON \
        NO_DOCS=ON \
        INSTALL_ALL_LANGS=ON \
        USE_SYSTEM_RTMIDI=ON \
        WITH_MAN=ON \
        WITH_TIMIDITY=ON \
        WITH_FLUIDSYNTH=ON \
        USE_FLUIDSYNTH=ON
    make
fi
}

package () {
    cd "${pkgname}-${pkgver}"
    if [ "$build_with_cmake" = "1" ]
    then
       make install -C build
    else
       make install INSTALL_ROOT=${pkgdir}
    fi
}
